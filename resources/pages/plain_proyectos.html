<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="../styles/plain.css">
		<link type="text/css" rel="stylesheet" href="../styles/plain_proyectos.css">
	</head>
	<body>
	
		<div class="box">
			<div class="row header">
				<div class="boton" onclick="location.href='plain_introduccion.html';">INTRODUCCIÓN</div>
				<div class="boton" onclick="location.href='plain_infopersonal.html';">INFO PERSONAL</div>
				<div class="boton" onclick="location.href='plain_proyectos.html';">PROYECTOS</div>
				<div class="boton" onclick="location.href='plain_formacion.html';">FORMACIÓN</div>
				<div class="boton" onclick="location.href='plain_programas.html';">PROGRAMAS</div>
				<div class="boton" onclick="location.href='plain_lenguajes.html';">LENGUAJES</div>
			</div>
		  
			<div class="row content">
				
				<div id="first_image_container">
					<div id="first_image_background"></div>
					<h1 id="first_image_text">PROYECTOS</h1>
				</div>
				
				<div id="body_content">
					<p>En esta sección podrás encotrar todos los proyectos en los que he estado trabajando y tengo públicos en un repositorio de GitHub</p>
					<br>
				</div>
				
				<script type="module">
					
					var descripciones_proyectos = []
					
					//función de iterador árbol
					function myIterator(value, index, array) {
						const file_name = value.path;
						const object = document.createElement("p")
						const object2 = document.createElement("p")
						const descripcion = descripciones_proyectos[index]
						
						object.innerHTML = "<a href=\"proyectos/"+file_name+"\">Enlace "+file_name.split(".")[0]+"</a>"
						object2.innerHTML = descripcion + "<br><br>"
						document.getElementById("body_content").appendChild(object)
						document.getElementById("body_content").appendChild(object2)
					}
					
					function httpGet(theUrl) {
						var xmlhttp;
						if (window.XMLHttpRequest)
						{// code for IE7+, Firefox, Chrome, Opera, Safari
							xmlhttp=new XMLHttpRequest();
						}
						else
						{// code for IE6, IE5
							xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
						}
						xmlhttp.onreadystatechange=function()
						{
							if (xmlhttp.readyState==4 && xmlhttp.status==200)
							{
								descripciones_proyectos = xmlhttp.responseText.match(/[^\r\n]+/g)
							}
						}
						xmlhttp.open("GET", theUrl, false);
						xmlhttp.send();    
					}
					
					/*
						rama principal: main
						prueba varios archivos: 1d35e49e5430907a2dd7b788e62dbac80b57074a
						carpeta a usar: bed244a816456a3dd1ba042820fecc39abc8eff5
					*/
					async function getFilesInToken(token){
						const list = await fetch("https://api.github.com/repos/AlvaroRadajczykProjects/AlvaroRadajczykProjects.github.io/git/trees/"+token).then(res => res.json());
						const tree = list.tree;
						return tree;
					}
					
					//console.log( await getFilesInProjectDirectory("resources/pages/proyectos") )
					async function getFilesInProjectDirectory(directory){
						const split = (directory).split("/");
						var tree = await getFilesInToken("main");
						const tam = split.length;
						for (let i = 0; i < tam; i++) {
							const folder_name = split.shift()
							const token = tree.find(node => node.path === folder_name).sha
							tree = await getFilesInToken(token)
						}
						return tree;
					}
					
					httpGet("proyectos/descripciones.txt")
					
					const lista = await getFilesInProjectDirectory("resources/pages/proyectos")
					lista.forEach(myIterator)				
					
				</script>
				
			</div>
		</div>
	
	</body>
</html>